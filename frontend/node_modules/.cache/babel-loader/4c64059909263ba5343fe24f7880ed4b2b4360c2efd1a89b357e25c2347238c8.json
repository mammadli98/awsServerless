{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{useCookies}from'react-cookie';import{useNavigate}from'react-router-dom';import'./UserPage.css';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function UserPage(){const[userData,setUserData]=useState(null);const[cookies,removeCookie]=useCookies(['email','password']);const navigate=useNavigate();const[updatedValue,setUpdatedValue]=useState({});useEffect(()=>{const fetchData=async()=>{if(!cookies.email||!cookies.password){navigate('/login');}else{try{// Fetch user authentication data\nconst authToken=\"\".concat(cookies.email,\"|\").concat(cookies.password);const authResponse=await axios.post('https://9xna35s7vi.execute-api.eu-central-1.amazonaws.com/dev/user/getAuth',{\"authorizationToken\":authToken});// Fetch user data\nconst response=await axios.post('https://9xna35s7vi.execute-api.eu-central-1.amazonaws.com/dev/user/readitem',{\"IDs\":[authResponse.data.ID]},{headers:{'Authorization':authToken}});setUserData(response.data[0]);// Take the first element from the response array\n}catch(error){console.error('Error:',error);}}};fetchData();},[]);const handleLogout=()=>{removeCookie('email');removeCookie('password');navigate('/login');};const handleUpdate=async fieldName=>{try{const updatedField=updatedValue[fieldName];if(updatedField!==undefined){const authToken=\"\".concat(cookies.email,\"|\").concat(cookies.password);const authResponse=await axios.post('https://9xna35s7vi.execute-api.eu-central-1.amazonaws.com/dev/user/getAuth',{\"authorizationToken\":authToken});console.log(fieldName);if(fieldName==\"Mail\"){await axios.post('https://9xna35s7vi.execute-api.eu-central-1.amazonaws.com/dev/user/updatemail',{\"ID\":authResponse.data.ID,\"Mail\":updatedField},{headers:{'Authorization':authToken}});document.cookie=\"email=\".concat(updatedField,\"; path=/\");}else if(fieldName==\"Name\"){await axios.post('https://9xna35s7vi.execute-api.eu-central-1.amazonaws.com/dev/user/updatelastname',{\"ID\":authResponse.data.ID,\"Name\":updatedField},{headers:{'Authorization':authToken}});}// Refresh user data after update\nconst response=await axios.post('https://9xna35s7vi.execute-api.eu-central-1.amazonaws.com/dev/user/readitem',{\"IDs\":[authResponse.data.ID]},{headers:{'Authorization':\"\".concat(cookies.email,\"|\").concat(cookies.password)}});setUserData(response.data[0]);setUpdatedValue({});window.location.reload();}}catch(error){console.error('Error updating data:',error);}};const handleChange=(fieldName,value)=>{setUpdatedValue({...updatedValue,[fieldName]:value});};return/*#__PURE__*/_jsx(\"div\",{className:\"UserPage\",children:userData?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Welcome \",userData.Vorname,\"!\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,children:\"Logout\"}),/*#__PURE__*/_jsx(\"table\",{className:\"userTable\",children:/*#__PURE__*/_jsx(\"tbody\",{children:Object.entries(userData).map(_ref=>{let[fieldName,value]=_ref;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"label\",children:fieldName}),/*#__PURE__*/_jsx(\"td\",{className:\"value\",children:value}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:updatedValue[fieldName]||'',onChange:e=>handleChange(fieldName,e.target.value)}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleUpdate(fieldName),children:\"Update\"})]})]},fieldName);})})})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Please log in\"})});}export default UserPage;","map":{"version":3,"names":["React","useState","useEffect","axios","useCookies","useNavigate","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","UserPage","userData","setUserData","cookies","removeCookie","navigate","updatedValue","setUpdatedValue","fetchData","email","password","authToken","concat","authResponse","post","response","data","ID","headers","error","console","handleLogout","handleUpdate","fieldName","updatedField","undefined","log","document","cookie","window","location","reload","handleChange","value","className","children","Vorname","onClick","Object","entries","map","_ref","type","onChange","e","target"],"sources":["/home/mammadli98/Documents/ExamsDocuments/WS2324/DSG AWS/project-demo/src/UserPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { useCookies } from 'react-cookie';\nimport { useNavigate } from 'react-router-dom';\nimport './UserPage.css';\n\nfunction UserPage() {\n  const [userData, setUserData] = useState(null);\n  const [cookies, removeCookie] = useCookies(['email', 'password']);\n  const navigate = useNavigate();\n  const [updatedValue, setUpdatedValue] = useState({});\n\n  useEffect(() => {\n    const fetchData = async () => {\n      if (!cookies.email || !cookies.password) {\n        navigate('/login');\n      } else {\n        try {\n          // Fetch user authentication data\n          const authToken = `${cookies.email}|${cookies.password}`;\n          const authResponse = await axios.post(\n            'https://9xna35s7vi.execute-api.eu-central-1.amazonaws.com/dev/user/getAuth',\n            {\n              \"authorizationToken\": authToken \n            }\n          );\n\n          // Fetch user data\n          const response = await axios.post(\n            'https://9xna35s7vi.execute-api.eu-central-1.amazonaws.com/dev/user/readitem',\n            {\n              \"IDs\": [authResponse.data.ID]\n            },\n            {\n              headers: {\n                'Authorization': authToken\n              }\n            }\n          );\n          setUserData(response.data[0]); // Take the first element from the response array\n        } catch (error) {\n          console.error('Error:', error);\n        }\n      }\n    };\n\n    fetchData();\n  }, []);\n\n  const handleLogout = () => {\n    removeCookie('email');\n    removeCookie('password');\n    navigate('/login');\n  };\n\n  const handleUpdate = async (fieldName) => {\n    try {\n      const updatedField = updatedValue[fieldName];\n      if (updatedField !== undefined) {\n        const authToken = `${cookies.email}|${cookies.password}`;\n        const authResponse = await axios.post(\n          'https://9xna35s7vi.execute-api.eu-central-1.amazonaws.com/dev/user/getAuth',\n          {\n              \"authorizationToken\": authToken \n          }\n        );\n        console.log(fieldName);\n        if(fieldName == \"Mail\"){\n          await axios.post(\n            'https://9xna35s7vi.execute-api.eu-central-1.amazonaws.com/dev/user/updatemail',\n            {\n              \"ID\": authResponse.data.ID,\n              \"Mail\": updatedField\n            },\n            {\n              headers: {\n                'Authorization': authToken\n              }\n            }\n          );\n          document.cookie = `email=${updatedField}; path=/`;\n        }else if(fieldName == \"Name\"){\n          await axios.post(\n            'https://9xna35s7vi.execute-api.eu-central-1.amazonaws.com/dev/user/updatelastname',\n            {\n              \"ID\": authResponse.data.ID,\n              \"Name\": updatedField\n            },\n            {\n              headers: {\n                'Authorization': authToken\n              }\n            }\n          );\n        }\n        // Refresh user data after update\n        const response = await axios.post(\n          'https://9xna35s7vi.execute-api.eu-central-1.amazonaws.com/dev/user/readitem',\n          {\n            \"IDs\": [authResponse.data.ID]\n          },\n          {\n            headers: {\n              'Authorization': `${cookies.email}|${cookies.password}`\n            }\n          }\n        );\n        setUserData(response.data[0]);\n        setUpdatedValue({});\n        window.location.reload();\n      }\n    } catch (error) {\n      console.error('Error updating data:', error);\n    }\n  };\n\n  const handleChange = (fieldName, value) => {\n    setUpdatedValue({ ...updatedValue, [fieldName]: value });\n  };\n\n  return (\n    <div className=\"UserPage\">\n      {userData ? (\n        <>\n          <h1>Welcome {userData.Vorname}!</h1>\n          <button onClick={handleLogout}>Logout</button>\n          <table className=\"userTable\">\n            <tbody>\n              {Object.entries(userData).map(([fieldName, value]) => (\n                <tr key={fieldName}>\n                  <td className=\"label\">{fieldName}</td>\n                  <td className=\"value\">{value}</td>\n                  <td>\n                    <input\n                      type=\"text\"\n                      value={updatedValue[fieldName] || ''}\n                      onChange={(e) => handleChange(fieldName, e.target.value)}\n                    />\n                    <button onClick={() => handleUpdate(fieldName)}>Update</button>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </>\n      ) : (\n        <p>Please log in</p>\n      )}\n    </div>\n  );\n}\n\nexport default UserPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}